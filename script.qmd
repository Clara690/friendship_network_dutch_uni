---
title: "freshmen social network"
author: "Yun-Tsz Tsai"
format: pdf
editor: visual
excute: 
  echo: false
---

```{r}
#| echo: false
# load the necessary libraries
library(igraph)
library(dplyr)
library(sna)
```

# Data handling

The data comes in the form of an adjacency format. Thus, it is reasonable to keep its original shape and then turn it into an igraph object.

```{r}
# data collected at the beginning of the study
# load the adjacency matrix 
df1 <- read.csv('./data/t1.dat.', header = FALSE, sep = '')
# attributes 
atr <- read.csv('./data/cov1.dat', header = FALSE, sep = '')
# attached 
atr$node_id <- colnames(df1)

```

```{r}
# turn original data frame into a matrix
friendship_t1 <- as.matrix(df1)
# turn matrix into a graph
diag(friendship_t1) <- NA # set the values in diagonal dir to NA 
grph <- graph_from_adjacency_matrix(friendship_t1)

print(class(grph))
```

```{r}
plot.igraph(grph,
            vertex.label='',vertex.size=4,
            edge.color='darkgrey',edge.arrow.size=.2,
            layout=layout_with_kk(grph), 
            main='Friendship Network at A Dutch University')
```

```{r}
# the number of ties
length(as_edgelist(grph))
# the number of nodes that are isolated

paste('The number of individuals that are not connected to any other individuals is', length(isolates(friendship_t1)))
```

```{r}
# check for duplicates
length(unique(atr$V1)) == nrow(df1)

```

# Visualization of node attributes

```{r}
V(grph)$name[1:10]
```

```{r}
atr$node_id[1:10]
```

```{r}
# adding attribute to the exsiting network
 # V2 = gender
atr[match(V(grph)$name, atr$node_id), ]$V2
```

```{r}
V(grph)$gender <- atr[match(V(grph)$name, atr$node_id), ]$V2
plot.igraph(grph,
            vertex.label= '', vertex.color=ifelse(V(grph)$gender == 1,'royalblue','pink'), #1 = male, 2 = female
            edge.color='darkgrey',edge.arrow.size=.2,
            layout=layout_with_kk(grph),
            main='Friendship Network at A Dutch University \nblue: male, pink: female')
```
